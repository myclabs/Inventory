machine:
  php:
    version: 5.5.3

checkout:
  post:
    - |
      cat > application/configs/application.ini <<EOL
      [production]
      [test : production]
      [developpement : test]
      [testsunitaires : test]
      EOL
    - |
      cat > application/configs/parameters.php <<EOL
      <?php
      return [
          'application.url' => 'whatever',
          'db.host'         => '127.0.0.1',
          'db.name'         => 'circle_test',
          'db.user'         => 'ubuntu',
      ];
      EOL
    - |
      cat > application/configs/env.php <<EOL
      <?php
      defined('APPLICATION_ENV') || define('APPLICATION_ENV', 'testsunitaires');
      EOL

dependencies:
  cache_directories:
    - "vendor"

database:
  override:
    - php scripts/build/build.php -e testsunitaires update
    - php scripts/build/build.php -e testsunitaires populate

test:
  override:
    - phpunit
    - php scripts/build/build.php -e testsunitaires create update populate populateTest
